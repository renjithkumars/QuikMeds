@model QuikMeds.CustomerComment
@{

    var comments = ViewBag.Comments;
    var ratingSum = ViewBag.RatingSum;
    var ratingCount = ViewBag.RatingCount;

    decimal rating = 0;
    if (ratingCount > 0)
    {
        rating = (ratingSum / ratingCount);
    }
    var totalRating = decimal.Parse(rating.ToString());
}


<div class="list-view">
    @foreach (var item in ViewBag.productName)
    {
        <div class="list-item">
            <span class="p-cart">@item.Category</span>

            <span class="p-brand">@item.Brand</span>
            <span class="p-name">@item.PName</span>

            <span class="p-description">@item.Description<text>  Milli grams</text></span>

            <div class="add-to-cart">
                @Html.ActionLink("add to cart", "AddToCart", "Home", new { id = item.PID }, null)
                <span class="p-price">@String.Format("{0:c}", item.UnitPrice)</span>
            </div>
            <span class="p-unit">
                @item.UnitsInStock
                @if (item.UnitsInStock > 1)
                {
                    <text>units</text>
                }
                else
                {
                    <text>unit</text>
                }
            </span>
            <h4>
                Average Ratings
            </h4>
            <div>
                @for (var i = 1; i <= totalRating; i++)
                {
                    <span class="starGlowN"></span>
                }
                @for (var i = (totalRating + 1); i <= 5; i++)
                {
                    <span class="starFadeN"></span>
                }

                @using Microsoft.AspNet.Identity
                @if (Request.IsAuthenticated)
                {<hr />
                    @Html.Partial("_CommentBox")

                }
                else
                {
                    <br />
                    <div id="EmptyDataMsg" class="alert alert-info">
                        <strong>Welcome!</strong>      Please Login... To submit a review.
                    </div>
                }
            </div>

        </div>
    }




</div>


<div>
    <h4>CustomerComments</h4>
    <hr />
    @foreach (var c in comments)
    {
        <hr />
        <div class="row">

            <div class="col-md-2">
                @Html.Raw(c.Email.Replace("\n", "<br />"))


            </div>
            <div class="col-md-3">
                <i>@c.ThisDateTime</i>
                <br />
                @for (var i = 1; i <= c.Rating; i++)
                {
                    <span class="starGlowN"></span>
                }
                @for (var i = (c.Rating + 1); i <= 5; i++)
                {
                    <span class="starFadeN"></span>
                }
            </div>
            <div class="col-md-7">
                @Html.Raw(c.Comments.Replace("\n", "<br />"))

            </div>


        </div>
    }
</div>

